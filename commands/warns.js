const discord = require('discord.js'),
    discordBetter = require('discord.js-better');

module.exports = new discordBetter.Command('warns', [], (client, message) => {
    if (!message.member.hasPermission('MANAGE_MESSAGES')) return message.channel.send(new discord.MessageEmbed()
        .setTitle('__**üíª„ÉªThe Dev Center**__')
        .setColor('#ff0000')
        .setDescription(`Vous devez avoir la permission \`MANAGE_MESSAGES\` pour voir les warns d'un membre ${message.author}.`))
    const member = message.mentions.members.first()
    if (!member) return message.channel.send(new discord.MessageEmbed()
        .setTitle('__**üíª„ÉªThe Dev Center**__')
        .setColor('#ff0000')
        .setDescription(`Merci de mentionner un membre ${message.author}.`))
    if (member.id === message.author.id) return message.channel.send(new discord.MessageEmbed()
        .setTitle('__**üíª„ÉªThe Dev Center**__')
        .setColor('#ff0000')
        .setDescription(`Vous ne pouvez voir vos propres warns ${message.author}.`))
    if (member.id === message.guild.ownerID) return message.channel.send(new discord.MessageEmbed()
        .setTitle('__**üíª„ÉªThe Dev Center**__')
        .setColor('#ff0000')
        .setDescription(`Vous ne pouvez pas voir les warns du propri√©taire du serveur ${message.author}.`))
    if (member.hasPermission('ADMINISTRATOR')) return message.channel.send(new discord.MessageEmbed()
        .setTitle('__**üíª„ÉªThe Dev Center**__')
        .setColor('#ff0000')
        .setDescription(`Vous ne pouvez pas voir les warns d'un administrateur ${message.author}.`))
    if (member.roles.cache.has('858653929805185074')) return message.channel.send(new discord.MessageEmbed()
        .setTitle('__**üíª„ÉªThe Dev Center**__')
        .setColor('#ff0000')
        .setDescription(`Vous ne pouvez pas voir les warns d'un membre du staff ${message.author}.`))
    const users = client.dataManagers.get('users')
    if (!users.has(member.id) || users.get(member.id).warns.length == 0) return message.channel.send(new discord.MessageEmbed()
        .setTitle('__**üíª„ÉªThe Dev Center**__')
        .setColor('#ff0000')
        .setDescription(`${member} n'a pas de warns ${message.author}.`))
    const embed = new discord.MessageEmbed()
        .setTitle('__**üíª„ÉªThe Dev Center**__')
        .setColor('#00ff00')
    users.get(member.id).warns.forEach((warn, index) => embed.addField(`Warn ${index + 1}`, `Mod√©rateur : <@${warn.mod}> | Raison : ${warn.reason} | Date : ${discordBetter.DateUtils.humanizeDate(warn.date, 'Le %d/%mo/%y √† %h:%m:%s')}`))
    message.channel.send(embed)
}, false, false, { description: 'Affiche les warns d\'un membre.', syntax: '`<membre>`' });